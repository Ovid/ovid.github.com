
<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BVDP76N9NB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-BVDP76N9NB');
  </script>
  
  <!-- Facebook -->

  <meta property="fb:app_id" content="329861788447703" />
  
  <meta property="og:image" content="https://curtispoe.org/static/images/facebook/ovid-facebook.jpg" />
  <meta property="og:image:alt" content="A black and white image of the author, Curtis “Ovid” Poe." />
  
  <meta property="og:type" content="article" />
  
  <meta property="og:url" content="https://curtispoe.org/articles/how-databases-can-hurt-your-startup.html" />
  
  <meta property="og:title" content="How the Database Can Hurt Your Startup" />
  <meta property="og:description" content="The sad truth is that most developers don't know how to design a database and that's an expensive mistake." />

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="canonical" href="https://curtispoe.org/articles/how-databases-can-hurt-your-startup.html" />
  

  <!-- Basic Page Needs -->
  <meta charset="utf-8">
  <title>How the Database Can Hurt Your Startup</title>
  <meta name="description" content="How the Database Can Hurt Your Startup">
  <meta name="author" content="Curtis Poe">
  <link rel="alternate" type="application/rss+xml" title="Subscribe to my technical blog" href="https://curtispoe.org/article.rss" />
  <link rel="alternate" type="application/rss+xml" title="Subscribe to my personal blog" href="https://curtispoe.org/blog.rss" />

  <!-- Mobile Specific Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS -->
  <link rel="stylesheet" href="/static/css/normalize.css">
  <link rel="stylesheet" href="/static/css/skeleton.css">
  <link rel="stylesheet" href="/static/css/main.css">
  <link rel="stylesheet" href="/static/css/dialog.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/static/css/image.css">
    

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="images/favicon.png">

</head>
<body>

  <!-- Primary Page Layout -->
  <div class="container">
    <div class="row books">
        <div class="twelve columns header">
            <ul>
              <li><a href="https://www.amazon.com/Perl-Hacks-Programming-Debugging-Surviving/dp/0596526741/" target="_blank"><img src="/static/images/perl-hacks.jpg" alt="The cover of the 'Perl Hacks' book" class="book"></a></li>
              <li><a href="https://www.amazon.com/Beginning-Perl-Curtis-Poe/dp/1118013840/" target="_blank"><img src="/static/images/beginning-perl.jpg" alt="The cover of the 'Beginning Perl' book" class="book"></a></li>
              <li><img class="book" src="/static/images/profile.png" alt="An image of Curtis Poe, holding some electronic equipment in front of his face."></li>
            </ul>
        </div>
    </div>
    <div class="row title">
        <!-- Back to top button -->
        <span aria-hidden="true"><a href="#top" class="arrow"><button id="scrollToTopButton">↑</button></a></span>
        <h1><a name="-title-no-title-found-"></a>How the Database Can Hurt Your Startup</h1>
        <time>2018-09-16</time>
        
        <p><span id="time"></span> minute read</p>
        
        <hr>
        <div class="twelve columns header">
        </div>
    </div>
    <div class="row">
      
      <div class="two columns">
          <span id="wasm_search"></span>
  <!-- Note the usage of `type=module` here as this is an ES6 module -->
  <script type="module">
    // Use ES module import syntax to import functionality from the module
    // that we have compiled.
    //
    // Note that the `default` import is an initialization function which
    // will "boot" the module and make it ready to use. Currently browsers
    // don't support natively imported WebAssembly as an ES module, but
    // eventually the manual initialization won't be required!
    // import { search, default as init } from './tinysearch_engine.js';
    import { search, default as init } from '/static/js/search/tinysearch_engine.js';
    window.search = search;

    async function run() {
      // First up we need to actually load the wasm file, so we use the
      // default export to inform it where the wasm file is located on the
      // server, and then we wait on the returned promise to wait for the
      // wasm to be loaded.
      //
      // Note that instead of a string here you can also pass in an instance
      // of `WebAssembly.Module` which allows you to compile your own module.
      // Also note that the promise, when resolved, yields the wasm module's
      // exports which is the same as importing the `*_bg` module in other
      // modes
      await init('/static/js/search/tinysearch_engine_bg.wasm');
    }

    run();
  </script>

  <script>
    // And afterwards we can use all the functionality defined in wasm.
    function doSearch() {
      let value = document.getElementById("demo").value;
      console.log(`Search query: ${value}`);

      const results = search(value, 5);

      console.log(`Results: ${results}`);

      let ul = document.getElementById("results");
      ul.innerHTML = "";

      for (i = 0; i < results.length; i++) {
        var li = document.createElement("li");

        let [title, url] = results[i];
        let elemlink = document.createElement('a');
        elemlink.innerHTML = title;
        elemlink.setAttribute('href', url);
        li.appendChild(elemlink);

        ul.appendChild(li);
      }
    }
	// https://stackoverflow.com/questions/47879864/how-can-i-check-if-a-browser-supports-webassembly#:~:text=There%20are%20a%20few%20ways,js).
	const wasm_supported = (() => {
		try {
			if (typeof WebAssembly === "object"
				&& typeof WebAssembly.instantiate === "function") {
				const module = new WebAssembly.Module(Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00));
				if (module instanceof WebAssembly.Module)
					return new WebAssembly.Instance(module) instanceof WebAssembly.Instance;
			}
		} catch (e) {
		}
		return false;
	})();
    if (!wasm_supported) {
      // don't even show them the search box if they don't have web assembly
      // document.getElementById("wasm_search").innerHTML = "Your browser does not support WebAssembly. Please use a modern browser.";
    }
    else {
      document.getElementById("wasm_search").innerHTML = '<div id="search"><strong>Search</strong><input type="text" id="demo" onkeyup="doSearch()"><ul id="results"></ul><div><hr>';
    }
  </script>

        <ul>
          <li><a href="/index.html">Home</a></li>
          <li><a href="/articles.html">Articles</a> <a href="/article.rss"><img border="0" alt="Subscribe to Articles by Ovid" src="/static/images/rss.png" width="12" height="12"/></a></li>
          <li><a href="/blog.html">Blog</a> <a href="/blog.rss"><img border="0" alt="Subscribe to Blogs by Ovid" src="/static/images/rss.png" width="12" height="12"/></a></li>
          <li><a href="/videos.html">Talks</a></li>
          <li><a href="/hireme.html">Hire Me</a></li>
          <li><a href="/wildagile.html">WildAgile</a></li>
          <!-- <li><a href="/tau-station.html">Tau Station</a></li> -->
          <li><a href="/starmap.html">Starmap</a></li>
          <li><a href="/escape.html"><strong>Escape!</strong></a></li>
        </ul>
        <hr>
        <strong>Find me on ...</strong>
        <ul>
          <li><a href="https://www.linkedin.com/in/curtispoe/">LinkedIn</a></li>
          <li><a href="https://github.com/Ovid/">GitHub</a></li>
          <li><a href="https://fosstodon.org/@ovid" rel="me">Mastodon</a></li>
          <li><a href="https://bsky.app/profile/ovid.bsky.social">Bluesky</a></li>
        </ul>
        <strong>Tags</strong>
        <ul class="cloud" role="navigation" aria-label="Tag cloud for Ovid's site">
        
            <li><a href="/tags/programming.html" data-weight="9">Software</a></li>
        
            <li><a href="/tags/business.html" data-weight="6">Business</a></li>
        
            <li><a href="/tags/oop.html" data-weight="5">OOP</a></li>
        
            <li><a href="/tags/perl.html" data-weight="5">Perl</a></li>
        
            <li><a href="/tags/ai.html" data-weight="4">AI</a></li>
        
            <li><a href="/tags/corinna.html" data-weight="4">Corinna</a></li>
        
            <li><a href="/tags/databases.html" data-weight="3">Databases</a></li>
        
            <li><a href="/tags/personal.html" data-weight="3">Personal</a></li>
        
            <li><a href="/tags/politics.html" data-weight="3">Politics</a></li>
        
            <li><a href="/tags/space.html" data-weight="3">Space</a></li>
        
            <li><a href="/tags/writing.html" data-weight="3">Writing</a></li>
        
            <li><a href="/tags/family.html" data-weight="2">Family</a></li>
        
            <li><a href="/tags/math.html" data-weight="2">Math</a></li>
        
            <li><a href="/tags/science.html" data-weight="2">Science</a></li>
        
            <li><a href="/tags/expat.html" data-weight="1">Moving Abroad</a></li>
        
        </ul>
      </div>

        <div class="ten columns verticalLine article">

        <div class="prevNext">
        
        <a href="/articles/a-simple-way-to-fix-legacy-code.html" class="prevPost">&laquo; A simple way to fix legacy code</a>
        
        <a href="/articles/zen-of-test-suites.html" class="nextPost">The Zen of test suites &raquo;</a>
    </div>

    

<ul class="inline" role="navigation" aria-label="Tag list for this articles">
    <li>Tags:</li>

    <li><a href="/tags/business.html">Business</a> </li>

    <li><a href="/tags/databases.html">Databases</a> </li>

</ul>


        <hr>
    <!-- nada -->





<p>Note: the following details a serious, expensive class of bugs that
your project may have, but that many don't know about. Out of necessity,
I'll lightly touch on technical details.</p>

<p>I was hiring developers for a large, complicated application. I
happened to mention to one of the more promising candidates that the
application was fairly write-heavy and we might experience some
performance concerns later. This developer, with years of experience and
skills across multiple technologies that might have been of use to us,
replied "you're going to either need to shard your database or switch to
NoSQL."</p>

<p>That was enough to guarantee they didn't get the job.</p>

<p>It's a distressingly common problem: with absolutely no understanding
of how the database was designed or what the application did, an
experienced developer made a strong declaration about how to fix a problem
we didn't yet have. In fact, when companies hire me for consulting, one of
the first things I do is examine the data storage layer. It's often in
pretty bad shape and a constant source of bugs because developers learn
SQL and think they understand databases.</p>

<p>If you take nothing else from this article, take this: <em>learning how to
write and optimize SQL has as much in common with designing a database as
being an expert mechanic qualifies you to design a car</em>.</p>

<h2><a name="data-quality-woes"></a>Data Quality Woes</h2>

<p>In many startups, there's not a lot of up front money, so a qualified
DBA is viewed as a luxury rather than a necessity. As a result, the devs
choose a data storage tool based on what they're comfortable with instead
of what the project actually requires. MySQL is so popular and easy to use
that many developers choose it out of habit, tune a few parameters for
performance, and start developing.</p>

<p>As the project grows, data issues are noticed and get fixed on an ad
hoc basis. Variants of the following bug abound:</p>

<pre><code>mysql&gt; create table example (tooshort varchar(3));
Query OK, 0 rows affected (0.00 sec)

mysql> insert into example (tooshort) values ("12345");
Query OK, 1 row affected, 1 warning (0.00 sec)

mysql&gt; select tooshort from example;
+----------+
| tooshort |
+----------+
| 123      |
+----------+</code></pre>

<p>As you can see from the above, MySQL happily truncated the data,
throwing away valuable information. It issued a warning, but most
applications ignore database warnings. For one of our clients, we found
two years of analytic data had to be thrown away because of this bug, even
though this warning was issued on every insert.</p>

<p>Once developers learn about MySQL's strict mode, they often try to
enable it, only to watch the application crash and burn because it was
written with the assumption that division by zero produces NULL values
instead of errors, "0000-00-00" is a real date, and many other tiny
problems. These same applications usually lack foreign key constraints, or
use them inconsistently. And more than one developer has solved deadlock
issues by not using database transactions.</p>

<p>By the time strict mode is finally enabled, there's a layer of bugs in
the database and a layer of related "strict mode workarounds" in the
application level. It becomes expensive to maintain and much development
effort is spent on correcting existing problems rather than build new
features that could earn new business.</p>

<p>Those who use Oracle or SQL Server often have databases just as bad, so
this isn't just a "MySQL thing." Curiously, we've noticed that our clients
who use PostgreSQL tend to have better quality databases, possibly
stemming from a database community which is obsessed with data
quality.</p>

<h2><a name="performance-woes"></a>Performance Woes</h2>

<p>For one company, a domain name registrar, I was helping them work on
fraud prevention tools when a project manager mentioned that a particular
query took 15 minutes to return. The team lead explained that there was
"too much data" to query efficiently. That "too much data" was only three
million records. After running explain on the query, I discovered they
weren't using indexes. A few minutes later, that 15 minute query took
under two seconds to run. Were it not for the accident of my being there,
they would have concluded the database was "too slow" and reached for a
NoSQL solution.</p>

<p>Another common issue, endemic with ORMs, is fetching multiple columns,
only to use two or three of them. Or discovering that MySQL often forces a
disk sort when fetching rows with text or blob fields, even if you're not
sorting on those fields. Or constantly updating only one column in a table
when 20 other columns that never change, causing a lot of unexpected disk
I/O. For these and many other issues, most of which are easy to solve,
devs who are unfamiliar with databases often reach for NoSQL solutions
without understanding why they had a problem in the first place. Quite
often they've traded a set of known problems for a set of unknown
problems. This is not a good business decision.</p>

<p>More to the point: before relational databases, all databases were
NoSQL. That's why we have relational databases.</p>

<h2><a name="data-is-king"></a>Data is King</h2>

<p>So why is this a big deal? Well, the term "information economy" isn't
bandied about for nothing. Consider that most applications have four
phases, though their structure might obscure this.</p>

<ol>
    <li>Initialization</li>
    <li>Input</li>
    <li>Calculation</li>
    <li>Output</li>
</ol>

<p>Virtually every application has those phases, but what do they mean?
Simply put:</p>

<ol>
    <li>Initialization of <em>data</em></li>
    <li>Input of <em>data</em></li>
    <li>Calculation of <em>data</em></li>
    <li>Output of <em>data</em></li>
</ol>

<p>Your application is all about data. For many people in management, they
see the app or the web page, but they don't see the database hidden
underneath. They understand that without their data the company is
probably in serious trouble, but they don't give much thought to it. In
fact, while total data loss will probably bankrupt your company, few give
much thought to the the standard data quality issues that are a constant
financial drain because it's assumed to be part of the cost of doing
business. And the developers who don't understand how to use databases
often tell management "that's just the way this technology works."</p>

<p>If there is one thing to take away from this article, it's to know that
a properly designed database will still allow you to add incorrect data
such as a misspelled first name, but it makes it hard to add invalid data,
such as an order which references a non-existant customer, or a negative
price for a product. Data maintenance costs drop significantly when you
have a great database.</p>

<p>Even the barest minimum of work understanding how to design databases
can tremendously improve quality. One of my most popular talks—rated 5 out
of 5 stars at OSCON—is "How to Fake a Database Design."</p>

<div class="video-responsive">
	<iframe width="560" height="315" src="https://www.youtube.com/embed/y1tcbhWLiUM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>


<p>You don't need to be an expert in databases to do a much better job of
using them. First, learn the basics of database design. Understand that
foreign key constraints, check constraints, and other tools are part of
that design, and not just "nice to have" features. Once you have your data
quality ensured, then you can worry about performance. As the old adage
goes "first make it work, then make it fast."</p>

<p>NoSQL, sharding, and other techniques to get performance wins can wind
up costing you a lot of money in the long run. Until you really understand
why your current database isn't fast enough, don't reach for the shiny
tools. You'll thank me later.</p>

<p>As an aside: I use and recommend NoSQL solutions from time to time (a
shout-out to Redis: I love Redis). I am not "anti-NoSQL." I simply find
that by properly designing databases and understanding the underlying
causes of database issues, NoSQL solutions often offer us little
value.</p>



          <p><strong>Please leave a comment below!</strong></p>



<script type="text/javascript">
    // estimated reading time
    // via https://dev.to/michaelburrows/calculate-the-estimated-reading-time-of-an-article-using-javascript-2k9l

    function readingTime() {
        const text  = document.getElementById("article").innerText;

        // The average eighth grader in the US reads about 250 words a minute, but your average
        // university student reads at almost twice that speed. However, my technical articles
        // are more in-depth and can take some time to think about, so be fair to the reader
        // and assume they'll take a bit longer for that.
        const wpm   = "articles" === "articles" ? 250 : 350;
        const words = text.trim().split(/\s+/).length;
        const time  = Math.ceil(words / wpm);
        document.getElementById("time").innerText = time;
    }
    readingTime();
</script>

<!-- map images pop up when you click them -->
<div id="overlay" class="overlay">
    <img id="overlayImage" src="" alt="Full-size image">
</div>
<script>
    function showOverlay(img) {
        const overlay = document.getElementById('overlay');
        const overlayImage = document.getElementById('overlayImage');
        overlayImage.src = img.src;
        overlayImage.alt = img.alt;
        overlay.style.display = 'block';
    }

    function hideOverlay() {
        const overlay = document.getElementById('overlay');
        overlay.style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', function() {
        const images = document.querySelectorAll('.image-container img');
        images.forEach(img => {
            img.addEventListener('click', function() {
                showOverlay(this);
            });
        });

        const overlay = document.getElementById('overlay');
        overlay.addEventListener('click', hideOverlay);
    });
</script>

<hr>
    <div class="prevNext">
        
        <a href="/articles/a-simple-way-to-fix-legacy-code.html" class="prevPost">&laquo; A simple way to fix legacy code</a>
        
        <a href="/articles/zen-of-test-suites.html" class="nextPost">The Zen of test suites &raquo;</a>
    </div>

<hr>

          <p>If you'd like top-notch consulting or training, <a
          href="mailto:curtis.poe@gmail.com">email me</a> and let's discuss
          how I can help you. Read my <a href="/hireme.html">hire me</a> page
          to learn more about my background.</p>
        </div>
    </div>
<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <div class="row">
      <div class="two columns">
        <p></p>
      </div>
      <div class="ten columns">
        <hr>
        <p>Copyright &copy; 2018-2025 by Curtis “Ovid” Poe.</p>
      </div>
    </div>
        <div id="disqus_thread"></div>
    <div class="row">
      <div class="twelve columns">
      
        <script>
        var disqus_config = function () {
            this.page.url        = "https://curtispoe.org/articles/how-databases-can-hurt-your-startup.html";
            this.page.identifier = "articles/how-databases-can-hurt-your-startup";
            this.page.title      = "How the Database Can Hurt Your Startup";
        };
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://https-ovid-github-io.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
      
        </div>
    </div>
    </div>
    
	
</body>
</html>

